<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Home Page</title>
    {% load static %}
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="{% static 'add_user/css/navbar.css' %}"> 
    <link rel="stylesheet" href="{% static 'add_user/css/home.css' %}">
     <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
</head>
<body>

<!-- Navbar -->
<nav class="navbar navbar-expand-custom navbar-mainbg">
    <a class="navbar-brand navbar-logo" style="color: white;" href="#">Online Tourist Guide</a>
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" 
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
        <i class="fas fa-bars text-white"></i>
    </button>
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
        <ul class="navbar-nav ml-auto">
            <div class="hori-selector"><div class="left"></div><div class="right"></div></div>
            <li class="nav-item"><a class="nav-link" href="{% url 'dashboard_page' %}"><i class="fas fa-tachometer-alt"></i> Dashboard</a></li>
            <li class="nav-item active"><a class="nav-link" href="#recommendation-section"><i class="far fa-address-book"></i> Recommendations</a></li>
            <li class="nav-item"><a class="nav-link" href="#flights"><i class="fa fa-tasks"></i> Flights</a></li>
            <li class="nav-item"><a class="nav-link" href="#hotels-section"><i class="far fa-calendar-alt"></i> Hotels</a></li>
            <li class="nav-item"><a class="nav-link" href="#map"><i class="far fa-chart-bar"></i> Map</a></li>
        </ul>
    </div>
</nav>

<!-- Video Section -->
<div class="video-container">
    <video autoplay loop muted>
        <source src="{% static 'videos/video2.mp4' %}" type="video/mp4">
        Your browser does not support the video tag.
    </video>
</div>
<section class="features-section" style="padding: 60px 20px; background-color:rgb(199, 223, 209); font-family: 'Segoe UI', sans-serif;">
    <div class="container" style="max-width: 1200px; margin: 0 auto;">
        <h2 style="font-size: 36px; color: #2c3e50; font-weight: 700; text-align: center; margin-bottom: 40px;">What We Offer</h2>
        <p style="font-size: 18px; color: #555; text-align: center; margin-bottom: 60px;">Explore the unique features of our Online Tourist Guide and plan your perfect trip!</p>

        <div style="display: flex; flex-wrap: wrap; gap: 40px; justify-content: center;">

            <!-- Feature 1: Interactive Destination Maps -->
            <div class="feature" style="background-color: #ffffff; padding: 20px; border-radius: 12px; box-shadow: 0 6px 15px rgba(0, 0, 0, 0.1); max-width: 320px; text-align: center; display: flex; flex-direction: column; height: 400px;">
                <img src="{% static 'add_user/images/maps.jpeg' %}" alt="Destination Maps" style="width: 100%; height: auto; border-radius: 8px; margin-bottom: 20px;">
                <h3 style="font-size: 24px; color: #2c3e50; margin-bottom: 15px;">Interactive Destination Maps</h3>
                <p style="font-size: 16px; color: #777; flex-grow: 1;">Navigate top tourist attractions with our user-friendly map interface. Explore your dream locations effortlessly.</p>
            </div>

            <!-- Feature 2: Personalized Travel Schedules -->
            <div class="feature" style="background-color: #ffffff; padding: 20px; border-radius: 12px; box-shadow: 0 6px 15px rgba(0, 0, 0, 0.1); max-width: 320px; text-align: center; display: flex; flex-direction: column; height: 400px; overflow: hidden;">
                <img src="{% static 'add_user/images/schedules.jpg' %}" alt="Personalized Travel Schedules" style="width: 100%; height: 150px; object-fit: cover; border-radius: 8px; margin-bottom: 15px; flex-shrink: 0;">
                <h3 style="font-size: 20px; color: #2c3e50; margin-bottom: 10px;">Personalized Travel Schedules</h3>
                <p style="font-size: 15px; color: #555; flex-grow: 1;">Create and manage your travel plans based on season, interests, and preferences. Stay organized and stress-free.</p>
            </div>

            <!-- Feature 3: Season-Based Recommendations -->
            <div class="feature" style="background-color: #ffffff; padding: 20px; border-radius: 12px; box-shadow: 0 6px 15px rgba(0, 0, 0, 0.1); max-width: 320px; text-align: center; display: flex; flex-direction: column; height: 400px;">
                <img src="{% static 'add_user/images/recommendation.jpeg' %}" alt="Season-Based Recommendations" style="width: 100%; height: auto; border-radius: 8px; margin-bottom: 20px;">
                <h3 style="font-size: 24px; color: #2c3e50; margin-bottom: 15px;">Season-Based Recommendations</h3>
                <p style="font-size: 16px; color: #777; flex-grow: 1;">Receive curated travel tips and destinations ideal for your chosen travel season. Plan your trip at the perfect time.</p>
            </div>

            <!-- Feature 4: Top Hotel Listings -->
            <div class="feature" style="background-color: #ffffff; padding: 20px; border-radius: 12px; box-shadow: 0 6px 15px rgba(0, 0, 0, 0.1); max-width: 320px; text-align: center; display: flex; flex-direction: column; height: 400px;">
                <img src="{% static 'add_user/images/hotels.jpg' %}" alt="Top Hotel Listings" style="width: 100%; height: auto; border-radius: 8px; margin-bottom: 20px; flex-shrink: 0;">
                <h3 style="font-size: 24px; color: #2c3e50; margin-bottom: 15px; flex-shrink: 0;">Top Hotel Listings</h3>
                <p style="font-size: 16px; color: #777; margin-top: 0; flex-grow: 1; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;">Discover recommended hotels with high ratings and scenic views, across Pakistan. Make your stay unforgettable.</p>
            </div>

            <!-- Feature 5: Live Flight Information -->
            <div class="feature" style="background-color: #ffffff; padding: 20px; border-radius: 12px; box-shadow: 0 6px 15px rgba(0, 0, 0, 0.1); max-width: 320px; text-align: center; display: flex; flex-direction: column; height: 400px;">
                <img src="{% static 'add_user/images/flights.jpg' %}" alt="Live Flight Information" style="width: 100%; height: auto; border-radius: 8px; margin-bottom: 20px;">
                <h3 style="font-size: 24px; color: #2c3e50; margin-bottom: 15px;">Live Flight Information</h3>
                <p style="font-size: 16px; color: #777; flex-grow: 1;">Access Duffel-powered live flight data to ensure timely and smooth travel. Stay updated with the latest flight schedules.</p>
            </div>

            <!-- Feature 6: Smart User Dashboard -->
            <div class="feature" style="background-color: #ffffff; padding: 20px; border-radius: 12px; box-shadow: 0 6px 15px rgba(0, 0, 0, 0.1); max-width: 320px; text-align: center; display: flex; flex-direction: column; height: 400px;">
                <img src="{% static 'add_user/images/dashboard.jpg' %}" alt="Smart User Dashboard" style="width: 100%; height: auto; border-radius: 8px; margin-bottom: 20px;">
                <h3 style="font-size: 24px; color: #2c3e50; margin-bottom: 15px;">Smart User Dashboard</h3>
                <p style="font-size: 16px; color: #777; flex-grow: 1;">Track your favorite destinations, tips, and schedules—all in one place. Simplifying travel planning for you.</p>
            </div>
        </div>
    </div>
     <div class="social-icons">
  <a href="https://twitter.com" class="twitter" target="_blank"><i class="fab fa-twitter"></i></a>
  <a href="https://instagram.com" class="instagram" target="_blank"><i class="fab fa-instagram"></i></a>
  <a href="https://facebook.com" class="facebook" target="_blank"><i class="fab fa-facebook-f"></i></a>
 <a href="https://youtube.com" class="youtube" target="_blank"><i class="fab fa-youtube"></i></a>
</div>
</section>


<!-- Search Form Section -->
<section id="recommendation-section">
<div class="container my-5 position-relative">
    <div class="row align-items-center">
        <!-- Left Thumbnails -->
        <div class="col-md-2 d-none d-md-flex flex-column align-items-center gap-3">
            <img src="{% static 'add_user/images/img1.jpg' %}" class="img-thumbnail rounded-circle shadow-sm" alt="Thumb 1" style="width: 120px; height: 120px;">
            <img src="{% static 'add_user/images/img2.jpg' %}" class="img-thumbnail rounded-circle shadow-sm" alt="Thumb 2" style="width: 120px; height: 120px;">
            <img src="{% static 'add_user/images/img3.jpg' %}" class="img-thumbnail rounded-circle shadow-sm" alt="Thumb 3" style="width: 120px; height: 120px;">
        </div>

        <!-- Main Content -->
        <div class="col-12 col-md-10 text-center">
            <h2 class="fw-bold" style="color: #30748c;">Find Your Recommended Destinations</h2>
            <p class="text-muted mb-4">Explore places tailored to your interests. Just type in what you love — from mountains to beaches — and we’ll guide you to the perfect spot.</p>

            <form id="interest-form" class="d-flex flex-column align-items-center gap-3">
                <input type="text" id="destination" name="destination" class="form-control form-control-lg shadow-sm rounded-pill px-4" placeholder="e.g., Mountains, Lakes, etc." required>
                <button type="submit" class="btn animated-btn">Search Interests</button>
            </form>

            <!-- Suggestions -->
            <div id="suggestions-container" class="mt-5" style="display:none;">
                <h3 class="text-success mb-4">Suggestions:</h3>
                <ul id="suggestions-list" class="list-group list-group-horizontal flex-wrap justify-content-center gap-3"></ul>
            </div>

            <!-- Recommendations -->
            <div id="recommendations-container" class="mt-5" style="display:none;">
                <h3 class="text-success mb-4">Recommended Destinations:</h3>
                <ul id="recommendations-list" class="list-group list-group-horizontal flex-wrap justify-content-center gap-3"></ul>
            </div>
        </div>
    </div>
</div>
</div>
</section>
<!-- Seasonal DEstination -->

<h1 style="text-align: center; font-size: 40px; color: #2c3e50; font-family: 'Poppins', sans-serif; margin-bottom: 40px;">
    Explore Top Destinations for {{ current_season }}
</h1>

<div class="destination-gallery">
    {% for destination in seasonal_destinations %}
        <div class="destination-item">
            <div class="destination-bg" style="background-image: url('{{ destination.image.url }}');"></div>
            <div class="destination-content">
                <h2>{{ destination.name }}</h2>
                <div class="activities">
                    {% for activity in destination.activities_list %}
                        <span class="activity-badge">{{ activity }}</span>
                    {% endfor %}
                </div>
            </div>
        </div>
    {% empty %}
        <p class="no-data">No destinations available for this season yet!</p>
    {% endfor %}
</div>

<!-- Section: Explore Flights -->
<section  id = "flights" class="py-5 bg-light">
    <div class="container">
      <div class="row align-items-center">
        <!-- Text Section -->
        <div class="col-md-6 mb-4 mb-md-0">
          <h2 class="fw-bold" style="color: #30748c;">✈️ Explore Flight Deals</h2>
          <p class="text-muted">
            Discover unbeatable flight offers tailored to your travel needs. Whether you're traveling for business or leisure, we have the perfect flight options just for you
          </p>
          <ul class="list-unstyled">
            <li>✅ Affordable international and domestic flights</li>
            <li>✅ Real-time availability and deals</li>
            <li>✅ Filter by cabin class, time, or route</li>
            <li>✅ Trusted by thousands of travelers</li>
          </ul>
          <button class="btn custom-btn mt-3" onclick="toggleFlightOffers()">Show Flight Offers</button>
        </div>
  
        <!-- Image Section -->
        <div class="col-md-6 text-center">
          <img src="{% static 'add_user/images/flight.png' %}"
               alt="Flight" class="img-fluid rounded shadow animate-fade-in" style="max-height: 350px;">
        </div>
      </div>
    </div>
  </section>
  
 <!-- Dynamic Flight Offers Section (Initially Hidden) -->
<div id="flight-offers-section" class="container d-none">
  <h2 class="custom-heading mb-4 text-center">✈️ Flight Offers</h2>

 {% if flight_offers %}
  <div class="row row-cols-1 row-cols-md-2 g-4">
    {% for offer in flight_offers %}
      <div class="col animate-fade-in">
        <div class="card shadow-sm h-100 border-0" style="border-left: 5px solid #30748c;">
          <div class="card-body">
            <h5 class="card-title text-success">
              Total: {{ offer.total_amount }} {{ offer.total_currency }}
            </h5>
            <p class="card-text"><strong>Cabin Class:</strong> {{ offer.cabin_class }}</p>
            <p class="card-text"><strong>Segments:</strong></p>
            <ul class="list-group list-group-flush">
              {% for slice in offer.slices %}
                {% for segment in slice.segments %}
                  <li class="list-group-item">
                    <span class="text-muted">{{ segment.departing_at }}</span><br>
                    <strong>{{ segment.origin.iata_code }}</strong>
                    → <strong>{{ segment.destination.iata_code }}</strong>
                  </li>
                {% endfor %}
              {% endfor %}
            </ul>

            <!-- ✅ BOOK BUTTON (inside loop and valid) -->
            <form method="post" action="{% url 'book_flight' %}" class="mt-3">
                {% csrf_token %}
                <input type="hidden" name="offer_id" value="{{ offer.id }}">
                <input type="hidden" name="offer_request_id" value="{{ offer_request_id }}">
                <button type="submit" class="btn btn-sm btn-primary">✈️ Book This Flight</button>
                </form>
          </div>
        </div>
      </div>
    {% endfor %}
  </div>
{% else %}
  <div class="alert alert-warning mt-4" role="alert">
    No flight offers available right now.
  </div>
{% endif %}

</div>

<section id="hotels-section" class="py-5">
    <div class="container">
        <div class="row align-items-center justify-content-between">
            <!-- Text Section (Appealing Content) -->
            <div class="col-md-6 mb-4 mb-md-0">
                <h2 class="fw-bold" style="color: #30748c;">🏨 Discover Your Dream Hotel</h2>
                <p class="text-muted mb-3">
                    Looking for a luxurious stay or a budget-friendly getaway? We’ve got the best hotel deals for you. 
                    From beachfront resorts to city center accommodations, find the perfect spot to relax and unwind during your travels.
                </p>
                <p class="text-muted mb-4">
                    Whether you're traveling for business or leisure, explore hotels with excellent amenities, great reviews, and unbeatable prices. 
                    Click below to find more!
                </p>
                <button class="btn custom-btn mt-3" onclick="toggleHotelInfo()">View Hotels</button>
            </div>

            <!-- Image Section -->
            <div class="col-md-6 text-center">
                <img src="{% static 'add_user/images/hotel.jpg' %}" alt="Hotel" class="img-fluid rounded shadow-lg" style="max-height: 350px;">
            </div>
        </div>
    </div>
</section>

<!-- Hidden Hotels Information (Initially Hidden) -->
<div id="hotel-info" class="container d-none">
    <h2 class="text-center text-primary mb-5">🏨 Available Hotels</h2>
    <div class="row row-cols-1 row-cols-md-2 row-cols-lg-3 g-4">
        {% for hotel in hotels %}
        <div class="col">
            <div class="card shadow-lg h-100 border-0" style="border-left: 5px solid #30748c;">
                <div class="card-body">
                    <!-- Hotel Image -->
                    <img src="/media/hotel_images/{{ hotel.image }}" class="card-img-top img-fluid hotel-img" alt="{{ hotel.name }}">
                    <h5 class="card-title text-success">{{ hotel.name }}</h5>
                    <p class="card-text"><strong>Location:</strong> {{ hotel.location }}</p>
                    <p class="card-text"><strong>Price per Night:</strong> Rs. {{ hotel.price_per_night }}</p>
                    <p class="card-text"><strong>Rating:</strong> ⭐ {{ hotel.rating }} / 5</p>
                    <p class="card-text">{{ hotel.description }}</p>
                </div>
            </div>
        </div>
        {% empty %}
        <p>No hotels available at the moment.</p>
        {% endfor %}
    </div>
</div>

<!-- Google Map Section -->
<footer style="background-color: #f8f9fa; padding: 40px 0; border-top: 2px solid #30748c;">
    <div class="container">
        <h3 class="text-center text-primary mb-4" style="font-size: 2rem; font-weight: 600;">Explore the Map Below</h3>
        <div class="input-group mb-4">
            <input id="pac-input" type="text" class="form-control border-2 border-primary shadow-sm" placeholder="Search for a place" style="font-size: 1.2rem;">
        </div>
        <div id="map" style="height: 500px; width: 100%; border-radius: 10px; border: 3px solid #30748c;"></div>
    </div>
</footer>

<!-- JS Scripts -->
<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAmWjkdhE63xsLmkvnTuVanJNcbZ4OacL0&libraries=places&callback=initMap" async defer></script>
<script src="{% static 'add_user/js/navbar.js' %}"></script>

{% block javascripts %}
<script>
    const form = document.getElementById('interest-form');
    const suggestionsContainer = document.getElementById('suggestions-list');
    const recommendationsContainer = document.getElementById('recommendations-list');
    const destinationInput = document.getElementById('destination');
    const suggestionsDiv = document.getElementById('suggestions-container');
    const recommendationsDiv = document.getElementById('recommendations-container');

    form.addEventListener('submit', async function(e) {
        e.preventDefault();  // Prevent the form from submitting traditionally

        const query = destinationInput.value.trim().toLowerCase();
        console.log("Query:", query);

        if (query) {
            try {
                const response = await fetch(`/interests/?query=${query}`);
                const data = await response.json();
                console.log("Response Data:", data);

                // Clear previous results
                suggestionsContainer.innerHTML = '';
                recommendationsContainer.innerHTML = '';

                // Display suggestions
                if (data.suggestions && data.suggestions.length > 0) {
                    data.suggestions.forEach(suggestion => {
                        const li = document.createElement('li');
                        li.textContent = suggestion;
                        suggestionsContainer.appendChild(li);
                    });
                    suggestionsDiv.style.display = 'block';  // Show suggestions container
                } else {
                    suggestionsContainer.innerHTML = '<li>No suggestions found.</li>';
                    suggestionsDiv.style.display = 'block';  // Show suggestions container
                }

                // Display recommendations
                if (data.recommendations && data.recommendations.length > 0) {
                    data.recommendations.forEach(recommendation => {
                        const li = document.createElement('li');
                        li.textContent = recommendation;
                        recommendationsContainer.appendChild(li);
                    });
                    recommendationsDiv.style.display = 'block';  // Show recommendations container
                } else {
                    recommendationsContainer.innerHTML = '<li>No recommendations found.</li>';
                    recommendationsDiv.style.display = 'block';  // Show recommendations container
                }

            } catch (error) {
                console.error('Error fetching data:', error);
            }
        }
    });
<!-- Map Initialization Script -->

function initMap() {
    const location = { lat: 33.6844, lng: 73.0479 }; // Example coordinates (Islamabad)
    
    const map = new google.maps.Map(document.getElementById("map"), {
        zoom: 8,
        center: location,
    });

    const marker = new google.maps.Marker({
        position: location,
        map: map,
    });

    // Adding Autocomplete functionality to the input
    const input = document.getElementById("pac-input");
    const autocomplete = new google.maps.places.Autocomplete(input);
    autocomplete.bindTo("bounds", map);
    
    autocomplete.addListener("place_changed", function() {
        const place = autocomplete.getPlace();
        if (!place.geometry) return;

        map.panTo(place.geometry.location);
        marker.setPosition(place.geometry.location);
    });
}
function toggleFlightOffers() {
    var offersContainer = document.getElementById("flight-offers-section");

    // Toggle visibility and apply the fade-in animation
    if (offersContainer.classList.contains("d-none")) {
        offersContainer.classList.remove("d-none");
        offersContainer.classList.add("visible");
    } else {
        offersContainer.classList.add("d-none");
        offersContainer.classList.remove("visible");
    }
}
  function toggleHotelInfo() {
        const hotelInfo = document.getElementById('hotel-info');
        if (hotelInfo.classList.contains('d-none')) {
            hotelInfo.classList.remove('d-none');
            hotelInfo.classList.add('d-block');
        } else {
            hotelInfo.classList.add('d-none');
            hotelInfo.classList.remove('d-block');
        }
    }

</script>
{% endblock %}

</body>
</html>
